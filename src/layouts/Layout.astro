---
import Navbar from '../components/Navbar.astro';

interface Props {
	title?: string;
}

const { title = "Astro Basics" } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
		<script is:inline>
			// Check for saved theme preference or system preference
			const theme = (() => {
				if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
					return localStorage.getItem('theme');
				}
				if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
					return 'dark';
				}
				return 'light';
			})();
		
			if (theme === 'light') {
				document.documentElement.classList.remove('dark');
			} else {
				document.documentElement.classList.add('dark');
			}
			window.localStorage.setItem('theme', theme);
		</script>
	</head>
	<body>
		<Navbar />
		<slot />
		<script>
			import { translations } from '../utils/translations';
			
			const updateLanguage = (lang) => {
				const texts = translations[lang];
				if (!texts) return;
				
				document.querySelectorAll('[data-i18n]').forEach(el => {
					const key = el.getAttribute('data-i18n');
					if (texts[key]) {
						el.textContent = texts[key];
					}
				});
			};

			// Listen for changes
			window.addEventListener('language-changed', (e: CustomEvent) => {
				updateLanguage(e.detail);
			});
			
			// Initial load
			document.addEventListener('DOMContentLoaded', () => {
				const savedLang = localStorage.getItem('language') || 'en';
				updateLanguage(savedLang);
			});
		</script>
	</body>
</html>

<style is:global>
	:root {
		--font-family: 'Poppins', sans-serif;
		
		/* Light Mode Colors */
		--bg-main: #FBFBFB;
		--bg-secondary: #E8F9FF;
		--accent-primary: #3B82F6; /* Changed from #C4D9FF for better visibility */
		--accent-secondary: #8B5CF6; /* Changed from #C5BAFF for better visibility */
		--text-color: #1f2937;
		--text-muted: #4b5563;
		
		/* High Contrast Text for Light Mode */
		--text-accent: #2563eb;
		--text-gradient-start: #2563eb;
		--text-gradient-end: #9333ea;
		
		/* Default to Light */
		--bg-color: var(--bg-main);
		--text-main: var(--text-color);
	}

	html.dark {
		/* Dark Mode Colors */
		--bg-main: #090040;
		--bg-secondary: #471396;
		--accent-primary: #B13BFF;
		--accent-secondary: #FFCC00;
		--text-color: #FBFBFB;
		--text-muted: #C4D9FF;
		
		/* High Contrast Text for Dark Mode */
		--text-accent: #B13BFF;
		--text-gradient-start: #B13BFF;
		--text-gradient-end: #FFCC00;
		
		--bg-color: var(--bg-main);
		--text-main: var(--text-color);
	}

	html {
		font-family: var(--font-family);
		font-size: 18px;
		scroll-behavior: smooth;
		scrollbar-width: thin;
		scrollbar-color: var(--accent-primary) var(--bg-main);
		background-color: var(--bg-color);
	}
	body {
		margin: 0;
		padding: 0;
		width: 100%;
		height: 100%;
		background-color: var(--bg-color);
		color: var(--text-main);
		transition: background-color 0.5s cubic-bezier(0.4, 0, 0.2, 1), color 0.5s cubic-bezier(0.4, 0, 0.2, 1);
	}
	
	/* Custom Scrollbar for Webkit */
	::-webkit-scrollbar {
		width: 10px;
	}
	
	::-webkit-scrollbar-track {
		background: var(--bg-main); 
	}
	
	::-webkit-scrollbar-thumb {
		background: var(--accent-secondary);
		border-radius: 5px;
		border: 2px solid var(--bg-main);
	}

	::-webkit-scrollbar-thumb:hover {
		background: var(--accent-primary);
	}
</style>
